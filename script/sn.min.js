$(function(){var $this;return $this={init:function(options){return null==options&&(options={}),$(this).sn("setup",options),$(this).sn("start")},setup:function(options){var sn;return null==options&&(options={}),window.sn={},sn={levels:{},users:{},content:{},conf:{},result:{},theme:{},settings:{}},$.extend(!0,sn,options),$(this).data("sn",sn),sn},start:function(options){return null==options&&(options={}),"undefined"!=typeof console&&null!==console&&console.log("configuration..."),$(this).snConf(),"undefined"!=typeof console&&null!==console&&console.log("autoload..."),$(this).snEvents("#autoload")}},$.fn.sn=function(sn){return null==sn&&(sn={}),$this[sn]?$this[sn].apply(this,Array.prototype.slice.call(arguments,1)):$this.init.apply(this,arguments)}}),$(function(){var $this;return $this={init:function(options){null==options&&(options={})},settings:function(){var sn;return sn=$(this).data("sn"),"undefined"!=typeof console&&null!==console&&console.log("conf: settings.json"),$.ajax({url:"conf/settings.json",async:!1,dataType:"json",success:function(s){return null!=s&&($.extend(sn.settings,s),sn.settings.enable=!0,sn.conf.settings=!0),$(this).data("sn",sn)}})}},$.fn.snConf=function(sn){return null==sn&&(sn={}),$this[sn]?$this[sn].apply(this,Array.prototype.slice.call(arguments,1)):$this.init.apply(this,arguments)}}),$(function(){var $this;return $this={init:function(options){var def,href,levels;if(null==options&&(options={}),def={href:"#autoload"},"object"!=typeof options?href=options:($.extend(!0,def,options),href=def.href),"#"!==href&&href.match(/#([a-zA-Z0-9\_\-]+)/)&&(levels={one:href.match(/#([a-zA-Z0-9\_\-]+)/,"$2"),two:href.match(/#[a-zA-Z0-9\_\-]+\/([a-zA-Z0-9\_\-]+)/,"$3"),three:href.match(/#[a-zA-Z0-9\_\-]+\/[a-zA-Z0-9\_\-]+\/([a-zA-Z0-9\_\-]+)/,"$4"),anchor:href.match(/\:([a-zA-Z0-9\_\-]+)/)},"undefined"!=typeof console&&null!==console&&console.info("url: "+href),"undefined"!=typeof console&&null!==console&&console.info("levels: ",levels),null!=levels.one&&"spoiler"!==levels.one[1])){switch(levels.one[1]){case"autoload":$(this).snMaps("loadMap");break;default:null!=levels.two&&null!=levels.three&&(window.sn.part=levels.one[1])}return $(this).click(levels)}}},$.fn.snEvents=function(sn){return null==sn&&(sn={}),$this[sn]?$this[sn].apply(this,Array.prototype.slice.call(arguments,1)):$this.init.apply(this,arguments)}}),$(function(){var $this;return $this={init:function(options){null==options&&(options={})},spoiler:function(){return"undefined"!=typeof console&&null!==console&&console.log("trigger: spoiler"),$(this).find(".spoiler-caption").on("click",function(e){return e.preventDefault(),$(this).hasClass("spoiler-open")?$(this).removeClass("spoiler-open").addClass("spoiler-close"):$(this).removeClass("spoiler-close").addClass("spoiler-open"),$(this).parent(".spoiler").children(".spoiler-body").each(function(){return $(this).hasClass("spoiler-open")?$(this).removeClass("spoiler-open").addClass("spoiler-close").hide():$(this).removeClass("spoiler-close").addClass("spoiler-open").show()})})}},$.fn.snTriggers=function(sn){return null==sn&&(sn={}),$this[sn]?$this[sn].apply(this,Array.prototype.slice.call(arguments,1)):$this.init.apply(this,arguments)}}),$(function(){var $this;return $this={init:function(options){var _this;return null==options&&(options={}),_this=this,"undefined"!=typeof console&&null!==console&&console.log("maps"),$(this).on("click",function(){})},loadMap:function(){return ymaps.ready(function(){var map;return map=new ymaps.Map("map",{center:[56.840001,53.239778],zoom:12,behaviors:["default","scrollZoom"]}),map.options.set("scrollZoomSpeed",1),map.controls.add("zoomControl"),map.controls.add("typeSelector"),map.controls.add("mapTools"),$this.getPoints(function(points){var clusterer,coordinates,coords,i,placemarks,point;clusterer=new ymaps.Clusterer,placemarks=[];for(i in points)point=points[i],coords=(""+point.POINT).replace(/[\s\[\]]/g,""),coordinates=[coords.replace(/^(.*)\,(.*)$/,"$1"),coords.replace(/^(.*)\,(.*)$/,"$2")],placemarks[i]=new ymaps.Placemark(coordinates,{hintContent:null!=point.PLAN_PERIOD_END?"до <b>"+(""+point.PLAN_PERIOD_END)+"</b>":void 0,balloonContentHeader:"Перекоп",balloonContentBody:'<div id="'+point.D$UUID+'">'+point.D$UUID+"</div>"},{balloonMinWidth:760,balloonMinHeight:320,preset:"0"===point.VID_ID?"twirl#workshopIcon":"twirl#turnRightIcon"}),"undefined"!=typeof console&&null!==console&&console.warn("vid_id",point.VID_ID);return"undefined"!=typeof console&&null!==console&&console.warn("placemarks",placemarks),clusterer.add(placemarks),clusterer.options.set({gridSize:100,maxZoom:16,minClusterSize:2}),map.geoObjects.add(clusterer)})})},getPoints:function(callback){return $.ajax({url:"index.php",type:"GET",data:{action:"getPoints"},dataType:"json",success:function(s){return"undefined"!=typeof console&&null!==console&&console.info(s),null!=s.points&&null!=callback?callback(s.points):void 0},error:function(XMLHttpRequest,textStatus,error){return"undefined"!=typeof console&&null!==console?console.log(XMLHttpRequest,textStatus,error):void 0}})}},$.fn.snMaps=function(sn){return null==sn&&(sn={}),$this[sn]?$this[sn].apply(this,Array.prototype.slice.call(arguments,1)):$this.init.apply(this,arguments)},$("#sn").snMaps()});